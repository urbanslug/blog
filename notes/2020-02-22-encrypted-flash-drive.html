<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <link rel="apple-touch-icon" sizes="57x57" href="../images/favicon/apple-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="../images/favicon/apple-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="../images/favicon/apple-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="../images/favicon/apple-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="../images/favicon/apple-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="../images/favicon/apple-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="../images/favicon/apple-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="../images/favicon/apple-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="../images/favicon/apple-icon-180x180.png">
        <link rel="icon" type="image/png" sizes="192x192" href="../images/favicon/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="96x96" href="../images/favicon/favicon-96x96.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon/favicon-16x16.png">
        <link rel="manifest" href="../images/favicon/manifest.json">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png">
        <meta name="theme-color" content="#ffffff">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <title>Encrypting and decypting a flash drive urbanslug</title>
    </head>
    <body>
      <div id="wrapper">
        <header>
          <div id="header-content">
            <nav>
                <a href="../">Home</a>
                <a href="../notes.html">Notes</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../subscribe.html">Subscribe</a>
            </nav>
          </div><!--header-content-->
        </header>
        <article>
          <h1 id="post-title">Encrypting and decypting a flash drive</h1>
          <div class="info">
    Posted on February 22, 2020
    
</div>
<div class="info">
    
    Tags: <a href="../tags/Encryption.html">Encryption</a>, <a href="../tags/Decryption.html">Decryption</a>
    
</div>

<p>Note:</p>
<ul>
<li>You need root for most of these commands</li>
<li>Replace X with the target drive letter</li>
</ul>
<h1 id="encrypting-a-flash-drive-that-was-previously-unencrypted">Encrypting a flash drive that was previously unencrypted</h1>
<ol style="list-style-type: decimal">
<li><p>Install cryptsetup</p>
<pre><code>pacman -S cryptsetup</code></pre></li>
<li><p>List your USB devices with either</p>
<pre><code>lsblk</code></pre>
<p>or</p>
<pre><code>fdisk -l</code></pre></li>
<li><p>Write random data to disk</p>
<pre><code>shred -v -n 1 /dev/sdX</code></pre>
<p>or</p>
<pre><code>dd if=/dev/urandom of=/dev/sdX bs=1M</code></pre></li>
<li><p>Set up a new dm-crypt device in LUKS encryption mode</p>
<pre><code>cryptsetup luksFormat /dev/sdX</code></pre></li>
<li><p>Set up mapping</p>
<pre><code>cryptsetup luksOpen /dev/sdX flashy</code></pre></li>
<li><p>Verify the new virtual block device mapper</p>
<pre><code>ls -arlt /dev/mapper | tail</code></pre></li>
<li><p>Format the disk with ext4</p>
<pre><code>mkfs -t ext4 /dev/mapper/flashy</code></pre></li>
<li><p>Create a mount location</p>
<pre><code>mkdir /run/mount/flashy</code></pre></li>
<li><p>Mount the device your filesystem:</p>
<pre><code>mount /dev/mapper/flashy /run/mount/flashy</code></pre></li>
<li><p>Verify the the mapper is properly mounted using the df command:</p>
<pre><code>df -h /run/mount/flashy</code></pre></li>
</ol>
<h1 id="accessing-your-flash-drive-later-on.">Accessing your flash drive later on.</h1>
<ol style="list-style-type: decimal">
<li><p>Decrypt the flash drive</p>
<pre><code>cryptsetup luksOpen /dev/sdX flashy </code></pre>
<p>Look it up</p>
<pre><code>ls -arlt /dev/mapper | tail</code></pre></li>
<li><p>Create a mount location</p>
<pre><code>mkdir /run/mount/flashy</code></pre></li>
<li><p>Mount the flash drive</p>
<pre><code>mount /dev/mapper/flashy /run/mount/flashy</code></pre></li>
<li><p>Access your files</p>
<pre><code>cd /run/mount/flashy</code></pre></li>
<li><p>Unmount the flash drive</p>
<pre><code>umount /run/mount/flashy</code></pre></li>
<li><p>Cleaup</p>
<pre><code>rm -r /run/mount/flashy</code></pre></li>
<li><p>Close your flash drive</p>
<pre><code>cryptsetup luksClose flashy</code></pre></li>
</ol>

<script src="https://carnivalapp.io/sites/413/init.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", Carnival.init);
</script>

        </article>

        <footer>
  <p>All work is under the terms of the <a href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License, Version 1.3</a></p>
  <p>Generated with <a href="https://jaspervdj.be/hakyll/">Hakyll</a>.</p>
        </footer>
      </div> <!-- #wrapper -->
    </body>
</html>
